function loading(t){this.load||(this.load=new LoadingView,Laya.stage.addChild(load)),this.index++,counter(t,this.index)}function counter(t,i){Laya.timer.once(100*i,this,function(){this.load.value=t,this.load.progress.bar.width=t*this.load.progress.width,this.load.percent.text=(100*t).toFixed()+"%",1==t&&this.loaded&&(initViews(),this.load.removeSelf())})}function initViews(){bg=new Laya.Image("commen/bg.png"),bg.scale(800/bg.width,600/bg.height),bg.width=800,bg.height=600,Laya.stage.addChild(bg),main=new MainView,Laya.stage.addChild(main)}function onLoaded(t){this.loaded=!0,cacheFrameAnimation(),player=document.createElement("audio"),player.src="mp3/dpmusic_main.mp3",player.loop=!0}function formatCurrency(t){t=t.toString().replace(/\$|\,/g,""),isNaN(t)&&(t="0"),sign=t==(t=Math.abs(t)),t=Math.floor(100*t+.50000000001),cents=t%100,t=Math.floor(t/100).toString(),cents<10&&(cents="0"+cents);for(var i=0;i<Math.floor((t.length-(1+i))/3);i++)t=t.substring(0,t.length-(4*i+3))+","+t.substring(t.length-(4*i+3));return(sign?"":"-")+t+"."+cents}function playSound(t,i){this.soundEnable&&(i?Laya.SoundManager.playSound("mp3/"+t+".mp3",0):Laya.SoundManager.playSound("mp3/"+t+".mp3"))}function stopSound(t){Laya.SoundManager.stopSound("mp3/"+t+".mp3")}function backgroundMusicPlay(t){t?isApp?window.webkit.messageHandlers.play.postMessage("play"):playBackgroundMusic():isApp?window.webkit.messageHandlers.pause.postMessage("pause"):stopBackgroundMusic()}function getAccountInfoFromNative(t){isApp=!0,playerAmount=t}function recieveMassage(t){main.onMessageReveived(t)}function closeWindow(){window.isApp?window.webkit.messageHandlers.slot.postMessage(JSON.stringify({cmd:"ExitGame",gameId:7})):socket.send(JSON.stringify({cmd:"ExitGame",gameId:7})),window.close(),isApp&&window.webkit.messageHandlers.close.postMessage("close")}function playBackgroundMusic(){player.play()}function stopBackgroundMusic(){player.pause()}function cacheFrameAnimation(){Laya.Animation.createFrames("res/atlas/bead.atlas","bead"),Laya.Animation.createFrames("res/atlas/dragon.atlas","dragon"),Laya.Animation.createFrames("res/atlas/fire.atlas","fire"),Laya.Animation.createFrames("res/atlas/golden.atlas","golden"),Laya.Animation.createFrames("res/atlas/money.atlas","money")}function getQueryString(t){var i=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(i);return null!=n?unescape(n[2]):null}!function(){function t(e,a){i=e,n=a,t.__super.call(this),this.init()}var i,n;Laya.class(t,"WPButton",Laya.Image),t.prototype.init=function(){this.skin=i,this.label=new Laya.Label(n),this.label.fontSize=25,this.label.color="white",this.label.x=(this.width-this.label.width)/2,this.label.y=(this.height-this.label.height)/2,this.addChild(this.label)}}(),function(){function t(){t.__super.call(this),this.init()}Laya.class(t,"LoadingView",LoadingUI),t.prototype.init=function(){}}(),function(){function t(){t.__super.call(this),this.init()}Laya.class(t,"GameInfo",GameInfoUI),t.prototype.init=function(){this.box.vScrollBar.visible=!1}}(),function(){function t(){t.__super.call(this),this.init()}Laya.class(t,"MusicEnable",MusicPromptUI);var i=t.prototype;i.init=function(){this.yes.title.text="是",this.no.title.text="否"},i.buttonClicked=function(t){var i=!1,n=Laya.Handler.create(this,t,null,!1);this.yes.on(Laya.Event.MOUSE_DOWN,this,function(){i=!0,t(i)},[n]),this.no.on(Laya.Event.MOUSE_DOWN,this,function(){i=!1,t(i)},[n])}}(),function(){function t(n){i=n,t.__super.call(this),this.init()}var i;Laya.class(t,"Border",Laya.Image),t.prototype.init=function(){var t=.825;this.skin=i;var n=new AnimateSprite;n.size(t*n.width,t*n.height),n.scale(t,t),n.x=10,n.y=10,this.addChild(n)}}(),function(){function t(i){t.__super.call(this),this.init(),this.label.text=i}Laya.class(t,"PromptView",PromptUI);var i=t.prototype;i.init=function(){this.bg.alpha=.3},i.buttonClick=function(t){var i=Laya.Handler.create(this,t,null,!1);this.button.on(Laya.Event.MOUSE_DOWN,this,function(t){this.removeSelf(),t&&t.run()},[i])}}(),function(){function t(i){this.acount=i,t.__super.call(this),this.init()}Laya.class(t,"AcountImage",Laya.View);var i=t.prototype;i.init=function(){for(var t=this.acount.toString(),i=0;i<t.length;i++){var n=t.charAt(i),e="";e=","==n?"number/comma.png":"."==n?"number/dot.png":"number/"+n+".png";var a=new Laya.Image(e);a.x=i*a.width,a.y=0,this.addChild(a)}},i.startCounter=function(t){this.acount=t,window.playSound("big_win_rollup",!0),this.removeChildren(0,this.numChildren);for(var i=t/5,n=0,e=0;e<5;e++)n+=i,this.addValue(n,e,5)},i.addValue=function(t,i,n){Laya.timer.once(300*i,this,function(){for(var e=Math.floor(1e4*t)/1e4,a=e.toString(),s=a.length;this.numChildren!=s;){var o=new Laya.Image;if(o.skin="number/0.png",o.x=this.numChildren*o.width,this.addChild(o),this.numChildren==s)break}console.log(i),this.skinImage(a);var l=(Math.floor(1e4*this.acount)/1e4).toString();console.log(a+"  "+l),i+1!=n&&a!=l||window.stopSound("big_win_rollup")})},i.skinImage=function(t){for(var i=0;i<this.numChildren;i++){var n=t.charAt(i),e="";e=","==n?"number/comma.png":"."==n?"number/dot.png":"number/"+n+".png";this.getChildAt(i).skin=e}}}(),function(){function t(n){e=3,i=n,t.__super.call(this),this.init()}var i,n,e=3;Laya.class(t,"AwardView",BounsRoundUI);var a=t.prototype;a.init=function(){window.playSound("tease"),this.bouns.y=this.height/2,this.bouns.alpha=0,i.sort(function(){return.5-Math.random()}),Laya.Tween.to(this.bouns,{alpha:1,y:20},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,function(){this.title.alpha=1;for(var t=0;t<this.itemBox.numChildren;t++){var i=this.itemBox.getChildAt(t);this.heightLight(i,t)}}));for(var t=0;t<i.length;t++){var n=i[t];"freeGame"==n.type?n.image=new Laya.Image("commen/dpbonus_04.png"):(n.image=new AcountImage(10*n.value),n.image.scale(.6,.6)),n.image.centerX=0,n.image.centerY=0}},a.mouseDown=function(t){n=Laya.Handler.create(this,t,null,!1);for(var i=0;i<this.itemBox.numChildren;i++){var e=this.itemBox.getChildAt(i);e.on(Laya.Event.MOUSE_DOWN,this,this.itemClick,[e,n])}},a.heightLight=function(t,i){Laya.timer.once(300*i,this,function(){Laya.Tween.to(t,{alpha:1},1e3),i==this.itemBox.numChildren-1&&Laya.timer.once(3e3,this,function(){for(var t=1;t<=e;t++)this.autoClick(t)})})},a.autoClick=function(t){Laya.timer.once(6e4*t,this,function(){for(var t,i=0;i<this.itemBox.numChildren;i++){var e=this.itemBox.getChildAt(i);if(console.log("循环 :"+i),!e.pressed){t=e;break}}null!=t&&this.itemClick(t,n)})},a.itemClick=function(t,n){var a="bouns/bouns_dis.png";a=8==window.gameType?"bouns/bouns_dis.png":"commen/dpbonus_03.png",window.playSound("dpselected"),this.controlItems(!1),t.pressed=!0,e--,console.log(e),e>=0&&(Laya.Tween.to(t,{y:t.y-20},500,Laya.Ease.strongIn,Laya.Handler.create(this,function(){Laya.Tween.to(t,{y:t.y+20},1e3,Laya.Ease.elasticOut,Laya.Handler.create(this,function(){t.skin=a,t.addChild(i[e].image),this.controlItems(!0)}))})),this.leftImage.skin="number/"+e+".png",this.leftLabel.text="剩余::"+e,0==e&&(this.title.text="",Laya.timer.once(2e3,this,function(){for(var t=0;t<this.itemBox.numChildren;t++){this.itemBox.getChildAt(t).skin=a}}),Laya.timer.once(4e3,this,function(){this.removeSelf(),Laya.timer.once(3e3,this,function(){Laya.timer.clearAll(this),n&&n.run()})})))},a.controlItems=function(t){for(var i=0;i<this.itemBox.numChildren;i++){var n=this.itemBox.getChildAt(i);t&&!n.pressed?n.mouseEnabled=!0:n.mouseEnabled=!1}}}(),function(){function t(s,o,l,h){e=l,a=h,i=s,n=o,t.__super.call(this),this.init()}var i,n,e,a,s,o,l,h;Laya.class(t,"SlotIcon",Laya.View);var r=t.prototype;r.init=function(){this.added=!1,this.size(i,n),this.resizeIcon(e)},r.clearChild=function(){this.removeChildAt(0)},r.resizeIcon=function(t){this.icon=new Laya.Image(t);var n=this.icon.width/this.icon.height;o=this.icon.width>=120&&this.icon.width<=130?i-10:this.icon.width>130?8==window.gameType?150:126:this.icon.width>=200?200:this.icon.width,s=o/n,l=o/this.icon.width,h=s/this.icon.height,this.icon.scale(l,h),this.icon.size(o,s),this.originScaleX=l,this.icon.centerX=0,"style/F.png"==t?this.icon.y=2:this.icon.centerY=0,this.addChild(this.icon)},r.scaleAnimate=function(){0!=this.info.index&&1!=this.info.index||Laya.Tween.to(this.icon,{scaleX:1.2},200,Laya.Ease.strongIn,Laya.Handler.create(this,function(){Laya.Tween.to(this.icon,{scaleX:this.originScaleX},300,Laya.Ease.bounceOut)}))},r.showMarkIcon=function(){switch(this.icon.numChildren>0&&this.icon.removeChildren(0,this.icon.numChildren),this.info.index){case 0:this.addMarkIcon("commen/sq.png");break;case 1:this.addMarkIcon("commen/free_spins.png")}},r.addMarkIcon=function(t){var i=new Laya.Image(t);i.centerX=this.icon.centerX,i.y=this.icon.height-i.height,this.icon.addChild(i)},r.fuzzySkin=function(){var t=this.icon.skin,i=8;i=8==window.gameType?6:8;var n=t.substring(i,t.length);this.icon.skin="fuzzy/"+n,this.markIconDisplay(0)},r.clearlySkin=function(){var t=this.icon.skin,i="style/";i=8==window.gameType?"style/":"symbols/";var n=t.substring(6,t.length);this.icon.skin=i+n,this.markIconDisplay(1)},r.markIconDisplay=function(t){if(this.icon.numChildren>0)switch(this.info.index){case 0:case 1:this.icon.getChildAt(0).alpha=t}},r.playAnimation=function(){if("span"==this.info.animation)Laya.Tween.to(this.icon,{scaleX:1.2,scaleY:1.2},500,Laya.Ease.strongInOut,Laya.Handler.create(this,function(){Laya.Tween.to(this.icon,{scaleX:1,scaleY:1},500,Laya.Ease.strongInOut,Laya.Handler.create(this,function(){for(var t=0;t<2;t++)this.span(this.icon,t)}))}));else if(this.icon.alpha=0,!this.added){this.added=!0;var t=new Laya.Animation;t.interval=100,t.play(0,!0,this.info.animation),t.size(t.width*this.info.scale,t.height*this.info.scale),t.scale(this.info.scale,this.info.scale),"bead"==this.info.animation?(t.x=this.icon.x-10,t.y=this.icon.y-10):(t.x=this.icon.x,t.y=this.icon.y),this.addChild(t),Laya.timer.once(2e3,this,function(){t.stop(),t.clear(),t.removeSelf(),this.icon.alpha=1,this.added=!1})}},r.span=function(t,i){Laya.timer.once(1e3*i,this,function(){t.alpha=.5,Laya.timer.once(500,this,function(){t.alpha=1})})}}(),function(){function t(){t.__super.call(this),this.init()}var i;t.cached=!1,Laya.class(t,"AnimateSprite",Laya.Sprite),t.prototype.init=function(){i=new Laya.Animation,i.interval=100,this.addChild(i),t.cached||(console.log("cached"),Laya.Animation.createFrames("res/atlas/border.atlas","borderAnimation"),t.cached=!0),i.play(0,!0,"borderAnimation")}}(),function(){function t(){t.__super.call(this),this.init()}Laya.class(t,"ToastView",ToastUI);var i=t.prototype;i.init=function(){this.alpha=0},i.hide=function(){Laya.Tween.to(this,{alpha:0},1e3)},i.show=function(t){this.title.text=t,Laya.Tween.to(this,{alpha:1},1e3),Laya.timer.once(3e3,this,this.hide)}}(),function(){function t(n,e){i=n,this.maxValue=e,t.__super.call(this),this.init()}var i;Laya.class(t,"SliderView",SliderUI);var n=t.prototype;n.init=function(){this.value=i;var t=i/this.maxValue*this.width;this.fillView.graphics.drawRect(0,0,t,this.height,"#7aa016"),this.slider.x=t-5},n.onMouseDown=function(t){var i=Laya.Handler.create(this,t,null,!1);this.on(Laya.Event.MOUSE_DOWN,this,this.callBack,[i])},n.callBack=function(t){window.playSound("click"),this.slider.x=this.mouseX,this.value=Math.ceil(this.mouseX/this.width*this.maxValue),this.fillView.graphics.clear(),this.fillView.graphics.drawRect(0,0,this.slider.x+5,this.height,"#7aa016"),t&&t.runWith(this.value)}}(),function(){function t(){t.__super.call(this),this.init()}Laya.class(t,"RateListView",RateListUI),t.prototype.init=function(){this.panel.vScrollBar.visible=!1}}(),function(){function t(){t.__super.call(this),this.init()}var i,n,e,a,s;Laya.class(t,"BetSetView",BetSettingUI);var o=t.prototype;o.init=function(){s=this,i=new SliderView(.1,10),this.chipValue=i.value,i.pos(430,40),n=new SliderView(1,5),this.chips=n.value,n.pos(430,120),e=new SliderView(20,20),this.lineNumber=e.value,e.pos(430,200),this.addChild(i),this.addChild(n),this.addChild(e),a=new ToastView,a.pos((this.width-a.width)/2,400),this.addChild(a),i.onMouseDown(function(t){s.chipValue=t.toFixed(1),a.show(s.chipValue),s.showPrompt()}),n.onMouseDown(function(t){s.chips=t,a.show(t),s.showPrompt()}),e.onMouseDown(function(t){s.lineNumber=t,a.show(t),s.showPrompt()}),this.amount=this.chipValue*this.chips*this.lineNumber;var t="每线投注 ¥"+window.formatCurrency(this.chipValue*this.chips)+"投注线"+this.lineNumber+"赌注总额 ¥"+window.formatCurrency(this.amount);this.summary.text=t},o.showPrompt=function(){this.amount=this.chipValue*this.chips*this.lineNumber;var t="每线投注 ¥"+window.formatCurrency(this.chipValue*this.chips)+"投注线"+this.lineNumber+"赌注总额 ¥"+window.formatCurrency(this.amount);this.summary.text=t}}(),function(){function t(){t.__super.call(this),this.init()}var i;Laya.class(t,"ScrollSetView",SlotSettingUI);var n=t.prototype;n.init=function(){i=this,this.sliderView=new SliderView(0,500),this.sliderView.pos(430,120),this.addChild(this.sliderView),this.forwardBtn.on(Laya.Event.MOUSE_DOWN,this,this.forwardBtnPressed),this.toast=new ToastView,this.toast.pos((this.width-this.toast.width)/2,400),this.addChild(this.toast),this.auto=0,this.sliderView.onMouseDown(function(t){i.auto=t,i.toast.show(t)}),this.forward=!1},n.forwardBtnPressed=function(){window.playSound("click"),this.forward=!this.forward,this.forward?this.forwardBtn.skin="setting/switch_on.png":this.forwardBtn.skin="setting/switch_off.png"},n.callBack=function(t){}}(),function(){function t(){t.__super.call(this),this.init()}Laya.class(t,"AudioSetView",VioceSettingUI);var i=t.prototype;i.init=function(){this.voiceEnable=!1,this.musicEnable=!1,this.voiceBtn.on(Laya.Event.MOUSE_DOWN,this,this.voiceBtnPressed),this.musicBtn.on(Laya.Event.MOUSE_DOWN,this,this.musicBtnPressed)},i.voiceBtnPressed=function(){window.playSound("click"),this.voiceEnable=!this.voiceEnable,this.setButtonSkin(),window.soundEnable=this.voiceEnable,this.voiceEnable||Laya.SoundManager.stopAllSound()},i.musicBtnPressed=function(){window.playSound("click"),this.musicEnable=!this.musicEnable,window.backgroundMusicPlay(this.musicEnable),this.setButtonSkin()},i.setButtonSkin=function(){this.voiceEnable?this.voiceBtn.skin="setting/switch_on.png":this.voiceBtn.skin="setting/switch_off.png",this.musicEnable?this.musicBtn.skin="setting/switch_on.png":this.musicBtn.skin="setting/switch_off.png"}}(),function(){function t(){t.__super.call(this),this.init()}var i,n,e,a,s=["音响设定","转动设定","下注设定","赔率表","讯息"];Laya.class(t,"Setting",SettingUI);var o=t.prototype;o.init=function(){_this=this,this.initViews(),a=this.tab.x-50,e=new Laya.View,e.size(this.tab.width/5,8),e.pos(a,105),e.graphics.drawRect(0,0,100,8,"white"),this.addChild(e),this.tab.selectedIndex=s.length-1,this.onSelect(this.tab.selectedIndex),this.tab.selectHandler=new Laya.Handler(this,this.onSelect)},o.back=function(t){this.backBtn.on(Laya.Event.MOUSE_DOWN,this,function(){window.playSound("click");var i={music:this.audioSet.musicEnable,volumn:this.audioSet.voiceEnable,forward:this.scrollSet.forward,autoScrollCount:this.scrollSet.auto,bet:this.amountSet.chipValue,odds:this.amountSet.chips,lines:this.amountSet.lineNumber,amount:this.amountSet.amount},n=Laya.Handler.create(this,t,[i],!1);Laya.Tween.to(this,{y:-600},500,Laya.Ease.linearNone,n)})},o.onSelect=function(t){window.playSound("click");for(var i=0;i<this.tab.numChildren;i++){var n=this.tab.getChildAt(i);i==t?(n.scale(1.2,1.2),e.x=a+n.x):n.scale(1,1)}this.title.text=s[t],this.switchView(t)},o.switchView=function(t){n.x=-800*t},o.initViews=function(){n=new Laya.Box,n.pos(0,103),n.size(800,500),this.addChild(n),this.audioSet=new AudioSetView,this.audioSet.pos(0,0),n.addChild(this.audioSet),this.scrollSet=new ScrollSetView,this.scrollSet.pos(800,0),n.addChild(this.scrollSet),this.amountSet=new BetSetView,this.amountSet.pos(1600,0),n.addChild(this.amountSet),i=new RateListView,i.pos(2400,0),i.size(800,1500),n.addChild(i);var t=new GameInfo;t.pos(3200,0),t.size(800,1500),n.addChild(t)},o.setOption=function(t){this.audioSet.voiceEnable=t.volumn,this.audioSet.musicEnable=t.music,this.audioSet.setButtonSkin(),console.log(t)}}(),function(){function t(){t.__super.call(this),this.init()}var i,n,e,a,s,o,l,h,r,c,d,u,m,f=[],p=[],g=[{index:8,image:"symbols/H1.png",animation:"fire",scale:.9},{index:9,image:"symbols/H2.png",animation:"money",scale:.85},{index:10,image:"symbols/H3.png",animation:"golden",scale:.95},{index:2,image:"symbols/L1.png",animation:"span",scale:1},{index:3,image:"symbols/L2.png",animation:"span",scale:1},{index:4,image:"symbols/L3.png",animation:"span",scale:1},{index:5,image:"symbols/L4.png",animation:"span",scale:1},{index:6,image:"symbols/L5.png",animation:"span",scale:1},{index:7,image:"symbols/L6.png",animation:"span",scale:1},{index:0,image:"symbols/S.png",animation:"bead",scale:.8},{index:1,image:"symbols/W.png",animation:"dragon",scale:.8}],y=[],w=[],v=(g.length,0),L=20,b=Laya.Event,S=Laya.Socket,x={cmd:"videoSlot",bet:.1,odds:1,lines:20,gameType:7},C=[],k=0,_=!1,A=0,E=0,B={music:!1,volumn:!1,forward:!1,autoScrollCount:0,amount:2},I=[{id:1,lineName:"line/xian_1.png",x:-20,y:148},{id:2,lineName:"line/xian_2.png",x:-20,y:47},{id:3,lineName:"line/xian_3.png",x:-20,y:296},{id:4,lineName:"line/xian_4.png",x:-25,y:10},{id:5,lineName:"line/xian_5.png",x:-30,y:52},{id:6,lineName:"line/xian_6.png",x:-25,y:47},{id:7,lineName:"line/xian_7.png",x:-25,y:111},{id:8,lineName:"line/xian_8.png",x:-25,y:37},{id:9,lineName:"line/xian_9.png",x:-25,y:185},{id:10,lineName:"line/xian_10.png",x:-25,y:47},{id:11,lineName:"line/xian_11.png",x:25,y:52},{id:12,lineName:"line/xian_12.png",x:10,y:52},{id:13,lineName:"line/xian_13.png",x:10,y:52},{id:14,lineName:"line/xian_14.png",x:0,y:64},{id:15,lineName:"line/xian_15.png",x:10,y:0},{id:16,lineName:"line/xian_16.png",x:0,y:37},{id:17,lineName:"line/xian_17.png",x:10,y:52},{id:18,lineName:"line/xian_18.png",x:0,y:47},{id:19,lineName:"line/xian_19.png",x:0,y:74},{id:20,lineName:"line/xian_20.png",x:10,y:74}],M=0,N=[],V=0,O={isFire:!1,index:0},T=0,W=0,D=0;Laya.class(t,"MainView",GameUI),t.cached=!1;var F=t.prototype;F.init=function(){i=this,E=window.playerAmount,window.isApp?(this.musicToast(),window.webkit.messageHandlers.slot.postMessage(JSON.stringify({cmd:"EnterGame",gameId:7}))):this.connect();var t=window.formatCurrency(E);this.balance.text="余额 "+(10*E).toFixed(1),this.amount.text="¥"+t,a=new Laya.Panel,a.size(678,370);var e=(this.background.width-a.width)/2;a.pos(e,100),this.background.addChild(a),this.layoutIcons(),n=new Setting,n.alpha=0,n.pos(0,-700),this.addChild(n),this.runBtn.on(Laya.Event.MOUSE_DOWN,this,function(){if(window.playSound("click"),E<B.amount||E<=0){var t=new PromptView("余额不足");i.addChild(t),t.buttonClick(function(){console.log("余额不足")})}else B.autoScrollCount>0?"commen/control_panel_mobile_06.png"==this.runBtn.skin?(this.runBtn.skin="commen/control_panel_mobile_03.png",this.sendBet(),this.toastLabel.text="自动旋转::"+B.autoScrollCount):(B.autoScrollCount=0,this.runBtn.skin="commen/onclick.png",this.runBtn.alpha=0):(this.sendBet(),this.buttonDisplay(!1),this.toastLabel.text="祝你好运！")}),this.settingBtn.on(Laya.Event.MOUSE_DOWN,this,function(){window.playSound("click"),n.alpha=1,Laya.Tween.to(n,{y:0},500),n.back(function(t){console.log(t),i.displayLines(t.lines),x.bet=t.bet,x.odds=t.odds,x.lines=t.lines,B.amount=t.amount,B.autoScrollCount=t.autoScrollCount,B.forward=t.forward,i.totalBet.text="赌注总额"+10*t.amount.toFixed(),i.bet.text="¥"+window.formatCurrency(t.amount),t.autoScrollCount>0&&(i.runBtn.skin="commen/control_panel_mobile_06.png"),L=t.forward?30:20,i.changeSpeed(L),B.volumn=t.music,B.music=t.volumn,window.soundEnable=t.volumn,n.alpha=0})}),this.closeBtn.on(Laya.Event.MOUSE_DOWN,this,function(){window.playSound("click"),this.removeSelf(),window.closeWindow()}),this.initMask(),this.setTimer()},F.setTimer=function(){Laya.timer.loop(1e3,this,function(){if(180==++M){var t=new PromptView("您已有3分钟未有下注，将于2分钟后退出游戏");this.addChild(t),t.buttonClick(function(){})}if(300==M){var t=new PromptView("您已经超过5分钟未有下注，已经自动退出游戏");this.addChild(t),t.buttonClick(function(){i.removeSelf(),window.closeWindow()}),Laya.timer.clearAll(this)}})},F.displayLines=function(t){for(var i=0;i<this.leftBox.numChildren;i++){var n=this.leftBox.getChildAt(i),e=this.rightBox.getChildAt(i);n.alpha=.3,e.alpha=.3}for(var a=0;a<t;a++){var s=I[a],o=new Laya.Image(s.lineName);o.x=s.x,o.y=s.y,l.addChild(o);for(var i=0;i<this.leftBox.numChildren;i++){var n=this.leftBox.getChildAt(i),e=this.rightBox.getChildAt(i);n.name==s.id&&(n.alpha=1),e.name==s.id&&(e.alpha=1)}}Laya.timer.once(1e3,this,function(){l.removeChildren(1,l.numChildren)})},F.initMask=function(){l=new Laya.Sprite,l.pos(a.x,a.y),l.size(a.width,a.height),l.cacheAs="bitmap",this.background.addChild(l),r=(l.width-48)/5,c=l.height/3,h=new Laya.Sprite,h.alpha=.3,h.size(l.width,l.height),l.addChild(h)},F.layoutIcons=function(){for(var t=0;t<5;t++){var i=new Laya.View;i.speed=L,i.size(126,g.length*(370/3)),i.pos(138*t,-(g.length-3)*(370/3)),g.sort(function(){return.5-Math.random()});for(var n=0;n<g.length;n++){var e=g[n],o=new SlotIcon(126,370/3,e.image,y[n]);o.pos(0,n*(370/3)),w.push(n*(370/3)),o.offset=0,i.addChild(o),o.info=e,o.showMarkIcon()}a.addChild(i),s=i.height}},F.switchMode=function(t){var i=g.length;if(w=[],D=t,0==t)for(var n=0;n<5;n++){var e=a.getChildAt(n);e.round=1+l,e.reverse=!1,e.pos(138*n,-(g.length-3)*(370/3));for(var l=0;l<i;l++){var h=e.getChildAt(l);w.push(h.y)}s=e.height}else for(var n=0;n<5;n++){var e=a.getChildAt(n);e.round=2,1==n||3==n?(e.reverse=!0,e.pos(138*n,0)):(e.reverse=!1,e.pos(138*n,-(g.length-3)*(370/3)));for(var l=0;l<i;l++){var h=e.getChildAt(l);w.push(h.y)}s=e.height,o=-370/3}},F.prepareResult=function(){e=[];for(var t=0;t<p.length;t++){var i=p[t];if(g.sort(function(){return.5-Math.random()}),1==D)if(1==t||3==t){for(var n=[],a=0;a<i.length;a++){var s=i[a],o=this.foundTargrt(s);n.push(o)}for(var l=0;l<g.length-i.length;l++)n.push(g[l]);e.push(n)}else this.pushArray(i);else this.pushArray(i)}},F.pushArray=function(t){for(var i=g.slice(0),n=0;n<t.length;n++){var a=t[n],s=this.foundTargrt(a);i.push(s),i.splice(0,1)}e.push(i)},F.foundTargrt=function(t){for(var i=0;i<g.length;i++){var n=g[i];if(n.index==t)return n}},F.scroll=function(){v=0,A=0,O.isFire=!1,O.index=0;var t=this.forwardStartIndex();t>1&&(O.isFire=!0,O.index=t);for(var i=0;i<a.numChildren;i++){var n=a.getChildAt(i);O.isFire?n.round=i>=t?6+i:i+1:n.round=1==D?2:1+i,n.offset=0;for(var s=e[i],o=0;o<n.numChildren;o++){var l=n.getChildAt(o);l.clearChild(),l.resizeIcon(s[o].image),l.info=s[o],l.showMarkIcon(),l.fuzzySkin()}}Laya.timer.frameLoop(1,this,this.start)},F.start=function(){for(var t=0;t<a.numChildren;t++){var i=a.getChildAt(t);if(i.round>0)for(var n=0;n<i.numChildren;n++){var e=i.getChildAt(n);if(i.reverse?(e.y-=i.speed,e.y<=o&&(i.offset++,e.pos(e.x,(g.length-1)*(370/3)))):(e.y+=i.speed,e.y>=s&&(i.offset++,e.pos(e.x,s-g.length*(370/3)))),i.offset==i.numChildren&&(i.round--,i.offset=0,i.round<=0)){if(O.isFire&&0==D&&v+1>=O.index&&(W++,l.removeChildren(1,l.numChildren),v<4)){var h=a.getChildAt(v+1);h.speed=30;var r=new Laya.Animation;r.loadAnimation("Particle.ani"),r.pos(h.x-20,-15),l.addChild(r),r.play(),r.scale(.8,.85)}v++,window.playSound("reel_stop-"+v),5==v&&(this.changeSpeed(L),W=0,Laya.timer.clear(this,this.start),B.forward||(L=20));for(var c=0;c<i.numChildren;c++){var e=i.getChildAt(c);e.clearlySkin(),Laya.Tween.to(e,{y:w[c]},1e3,Laya.Ease.elasticOut,Laya.Handler.create(this,this.stop))}}}}},F.stop=function(){if(++A==5*g.length)if(0!=f.length){h.graphics.drawRect(0,0,l.width,l.height,"#000000");for(var t=0;t<f.length;t++){var i=f[t];if(i.betType>0){for(var n=null,e=0;e<I.length;e++){var a=I[e];a.id==i.lineId&&(n=a)}this.heightLightItem(n,i,t,f.length)}}this.displayWinAmount(E,0),this.showWinText(k),this.showAmount()}else this.roundFinish()},F.showAmount=function(){var t=new AcountImage(10*k);t.scale(0,0),l.addChild(t),t.pivot(t.width/2,t.height/2),t.centerX=0,t.y=l.height-((c-t.height)/2+t.height/2),Laya.Tween.to(t,{scaleX:1,scaleY:1},500,Laya.Ease.elasticOut,Laya.Handler.create(this,function(){Laya.timer.once(2e3,this,function(){t.removeSelf()})})),window.playSound("win_summary")},F.heightLightItem=function(t,i,n,e){Laya.timer.once(2e3*n,this,function(){this.toastLabel.text="投注线"+t.id+"奖励："+i.win;var s=new Laya.Image(t.lineName);s.x=t.x,s.y=t.y,l.addChild(s),window.playSound("line_win");for(var o=0;o<i.points.length;o++){for(var r=i.points[o],c=p[r.column][r.row],d=a.getChildAt(r.column),u=0;u<d.numChildren;u++){var m=d.getChildAt(u);m.info.index==c&&m.playAnimation()}var f=new Laya.Sprite;f.blendMode="destination-out",f.size(r.width,r.height),f.x=r.x,f.y=r.y,f.graphics.drawRect(0,0,r.width,r.height,"#000000"),l.addChild(f);var g="kuang/"+t.id+".png",y=new Border(g);if(y.x=r.x-2,y.y=r.y-0,l.addChild(y),o+1==i.points.length){var w=new AcountImage(10*i.win);y.addChild(w),w.width=.4*w.width,w.height=.4*w.height,w.scale(.4,.4),w.x=(y.width-w.width)/2,w.y=(y.height-w.height)/2}}Laya.timer.once(1900,this,function(){l.removeChildren(1,l.numChildren),n+1==e&&(h.graphics.clear(),this.roundFinish())})})},F.roundFinish=function(){if(_)if(0==V)this.drawLottery();else if(V==N.length&&0!=V){for(var t=0,i=0;i<N.length;i++)for(var n=N[i],e=0;e<n.result.length;e++){var a=n.result[e];t+=a.win}this.scale(.6,.6),this.centerX=0,this.centerY=0,this.noFree(t),this.displayWinAmount(E,0),this.switchMode(0)}else{for(var a=0,n=N[V],i=0;i<n.result.length;i++){var s=n.result[i];a+=s.win}this.displayWinAmount(T,a),this.freeStart(V);var o=N.length-V-1;this.toastLabel.text="免费转动游戏剩余::"+o,this.buttonDisplay(!1)}else k<=0&&(this.toastLabel.text="没有赢"),B.autoScrollCount>0?(B.autoScrollCount--,Laya.timer.once(2e3,this,function(){this.sendBet(),this.toastLabel.text="自动旋转::"+B.autoScrollCount}),this.buttonDisplay(!0)):(this.runBtn.skin="commen/onclick.png",Laya.timer.once(1e3,this,function(){this.toastLabel.text="请按转动！"}),this.buttonDisplay(!0))},F.freeGameFinish=function(){V=0,N=[],this.buttonDisplay(!0),this.toastLabel.text="请按转动！",B.autoScrollCount>0&&(B.autoScrollCount--,Laya.timer.once(2e3,this,function(){this.sendBet(),this.toastLabel.text="自动旋转::"+B.autoScrollCount}))},F.musicToast=function(){Laya.timer.once(2e3,this,function(){var t=new MusicEnable;this.addChild(t),t.buttonClicked(function(i){window.soundEnable=i,B.volumn=i,B.music=i,t.removeSelf(),window.backgroundMusicPlay(B.music),n.setOption(B)}),Laya.timer.once(3e3,this,function(){t.removeSelf()})})},F.connect=function(){d=new S,d.connectByUrl(socketUrl),u=d.output,d.on(b.OPEN,this,function(){console.log("Connected");var t=getQueryString("SessionKey");if(t&&0!=t.length){var i={cmd:"Login",sessionKey:t,versions:"1.0"};d.send(JSON.stringify(i))}else d.send(JSON.stringify({cmd:"TrialGame",versions:"1.0"}));Laya.timer.loop(15e3,this,function(){d.send(JSON.stringify({cmd:"Heartbeat"}))}),this.musicToast()}),d.on(b.CLOSE,this,function(){}),d.on(b.MESSAGE,this,this.onMessageReveived),d.on(b.ERROR,this,function(t){var n=new PromptView("链接出错，请检查网络");this.addChild(n),n.buttonClick(function(){i.removeSelf(),window.closeWindow()})})},F.sendBet=function(){if(E<B.amount||E<=0){var t=new PromptView("余额不足");this.addChild(t),t.buttonClick(function(){console.log("余额不足")})}else{window.isApp?window.webkit.messageHandlers.slot.postMessage(JSON.stringify(x)):d.send(JSON.stringify(x)),E-=B.amount;var i=window.formatCurrency(E);this.balance.text="余额 "+(10*E).toFixed(1),this.amount.text="¥"+i,this.toastLabel.text="",this.win.text="",this.status.text="赢",console.log(x),M=0}},F.onMessageReveived=function(t){if(m=JSON.parse(t),0==m.status)switch(m.cmd){case"Login":console.log("登录成功"),d.send(JSON.stringify({cmd:"EnterGame",gameId:7}));break;case"TrialGame":d.send(JSON.stringify({cmd:"EnterGame",gameId:7}));break;case"EnterGame":d.send(JSON.stringify({cmd:"UserInfo"}));break;case"ExitGame":var n=new PromptView("链接已断开，请刷新重试");this.addChild(n),n.buttonClick(function(){n.removeSelf(),i.removeSelf(),window.close(),isApp&&window.webkit.messageHandlers.close.postMessage("close")}),Laya.timer.clearAll();break;case"UserInfo":E=m.amount;var e=window.formatCurrency(E);this.balance.text="余额 "+(10*E).toFixed(1),this.amount.text="¥"+e;break;case"videoSlot":console.log(m),T=E,E=m.amount,p=m.map,k=m.win,_=m.isFreeGame,_&&(C=m.prizeDraw,N=m.freeGame),this.prepareResultData(),this.prepareResult(),this.scroll()}else{var n=new PromptView("错误码："+m.status);this.addChild(n),n.buttonClick(function(){i.buttonDisplay(!0)})}isApp||d.input.clear()},F.forwardStartIndex=function(){for(var t=[],i=!0,n=0;n<p.length;n++)for(var e=p[n],a=0;a<e.length;a++){var s=e[a];if(0==s){i&&(i=!1,t.push(n));for(var o=0;o<t.length;o++){var l=t[o];n!=l&&t.push(n)}}}return 2==t.length?t[1]+1:0},F.prepareResultData=function(){f=0!=m.result.length?m.result:[];for(var t=0;t<f.length;t++)for(var i=f[t].points,n=0;n<i.length;n++){var e=i[n];e.width=r,e.height=c,e.spacing=12,e.x=e.column*(e.width+e.spacing),e.y=e.row*e.height}},F.drawLottery=function(){var t=new AwardView(C);this.addChild(t),t.mouseDown(function(){i.scale(.6,.6),i.centerX=0,i.centerY=0,i.freeSpins()})},F.buttonDisplay=function(t){t?(this.settingBtn.mouseEnabled=!0,this.closeBtn.mouseEnabled=!0,this.runBtn.mouseEnabled=!0,this.closeBtn.alpha=1,this.settingBtn.alpha=1,this.runBtn.alpha=1):(this.closeBtn.alpha=0,this.settingBtn.alpha=0,this.runBtn.alpha=0,this.settingBtn.mouseEnabled=!1,this.closeBtn.mouseEnabled=!1,this.runBtn.mouseEnabled=!1)},F.freeSpins=function(){for(var t=0,i=0,n=0;n<C.length;n++){var e=C[n];"money"==e.type?t+=e.value:i+=e.value}if(0==i?this.noFree(t):this.awardWithFreeSpins(i),t>=1e3){window.playSound("big_win");for(var n=0;n<10;n++)this.bigPrize(n)}this.displayWinAmount(T,t)},F.displayWinAmount=function(t,i){t+=i,T=t;var n=window.formatCurrency(t);this.balance.text="余额 "+(10*t).toFixed(1),this.amount.text="¥"+n,i>0?this.showWinText(i):(this.win.text="",this.status.text="赢")},F.showWinText=function(t){this.status.text="赢 "+(10*t).toFixed();var i=window.formatCurrency(t);this.win.text="¥"+i},F.noFree=function(t){var n=new Laya.Image("commen/you_win.png");n.centerX=0,n.y=50,Laya.stage.addChild(n);var e=new AcountImage(0);Laya.stage.addChild(e),e.startCounter(10*t),e.y=500;for(var a=t/5,s=0,o=0;o<5;o++)s+=a,this.increaseWin(s,o),e.centerX=0,this.spangleYouWin(n,o,5,function(){console.log("奖励结束"),_&&i.freeGameFinish(),n.removeSelf(),e.removeSelf(),i.scale(1,1)});this.showWinText(t)},F.spangleYouWin=function(t,i,n,e){Laya.timer.once(1e3*i,this,function(){t.alpha=1,Laya.timer.once(500,this,function(){t.alpha=0,i+1==n&&(t.alpha=1,e())})})},F.increaseWin=function(t,i){Laya.timer.once(300*i,this,function(){this.showWinText(t)})},F.awardWithFreeSpins=function(t){var i=new WPButton("commen/start.png","开始");i.centerX=0,i.y=480,Laya.stage.addChild(i),i.on(Laya.Event.MOUSE_DOWN,this,function(){n.removeSelf(),e.removeSelf(),i.removeSelf(),this.scale(1,1),this.freeStart(0),this.buttonDisplay(!1),window.playSound("click")});var n=new AcountImage(t);n.centerX=0,n.y=0,n.width=.8*n.width,n.height=.8*n.height,n.scale(.8,.8),Laya.stage.addChild(n);var e=new Laya.Image("commen/award.png");e.centerX=0,e.y=n.height,Laya.stage.addChild(e)},F.freeStart=function(t){0==t&&this.switchMode(1),M=0,Laya.timer.once(1e3,this,function(){V++;var i=N[t];m=i,console.log(m),p=m.map;var n=0;if(m.result.length>0)for(var e=0;e<m.result.length;e++){var a=m.result[e];n+=a.win}k=n,this.prepareResultData(),this.prepareResult(),this.scroll(),this.win.text="",this.status.text="赢"})},F.bigPrize=function(t){Laya.timer.once(2e3*t,this,function(){var t=new Laya.Animation;t.loadAnimation("Firework.ani");var i={x:10*Math.random()*100,y:10*Math.random()*50};t.x=i.x,t.y=i.y,Laya.stage.addChild(t),t.play(),window.playSound("firework"),t.on(Laya.Event.COMPLETE,this,function(){t.removeSelf()})})},F.changeSpeed=function(t){for(var i=0;i<a.numChildren;i++){a.getChildAt(i).speed=t}}}(),Laya.Render.isWebGL?(Laya.init(800,600,Laya.WebGL),Config.isAlpha=!0,
Laya.stage.bgColor="none"):(Laya.init(800,600),Laya.stage.bgColor=null),Laya.stage.scaleMode="showall",Laya.stage.screenMode="horizontal",Laya.stage.alignH="center",Laya.stage.alignV="middle";var bg=null,images=["res/atlas/commen.atlas","res/atlas/symbols.atlas","res/atlas/fuzzy.atlas","res/atlas/side.atlas","res/atlas/setting.atlas","res/atlas/number.atlas","res/atlas/border.atlas","res/atlas/bead.atlas","res/atlas/dragon.atlas","res/atlas/fire.atlas","res/atlas/golden.atlas","res/atlas/money.atlas","res/atlas/line.atlas","res/atlas/firework.atlas","res/atlas/kuang.atlas","res/atlas/particle.atlas"],gameType=7;this.soundEnable=!1,this.index=0,this.loaded=!1;var player;Laya.loader.load(images,laya.utils.Handler.create(this,onLoaded),Laya.Handler.create(this,loading,null,!1),Laya.loader.JSON),Array.prototype.contains=function(t){for(var i=this.length;i--;)if(this[i]===t)return!0;return!1};var main,isApp=!1,playerAmount=0,socketUrl="",hr=new Laya.HttpRequest;hr.once(Laya.Event.PROGRESS,this,function(t){}),hr.once(Laya.Event.COMPLETE,this,function(t){switch(typeof t){case"string":var i=JSON.parse(t);socketUrl=i.luck_localhost,console.log(t);break;case"object":socketUrl=t.luck_localhost,console.log(t);break;default:alert("config.json 配置错误")}}),hr.once(Laya.Event.ERROR,this,function(t){}),hr.send("/config.json",null,"get","text");